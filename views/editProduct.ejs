<%- include("partials/editheader") %>

<div class="container">
    <div class="row mt-5">
        <div class="col-lg-5">
            <div class="card">
                <img src="<%= product.productImage %>"   class="card-img-top" alt="...">
              </div>
        </div>
        <div class="col-lg-1"></div>
        <div class="col-lg-6 mt-5 d-flex justify-content-end">
            <div class="container ">
                <form class="form-group" method="POST"  action="/admin/<%= product._id %>/edit?_method=PUT"  >
                    <div class="">
                      <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-box-seam" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5l2.404.961L10.404 2l-2.218-.887zm3.564 1.426L5.596 5 8 5.961 14.154 3.5l-2.404-.961zm3.25 1.7l-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923l6.5 2.6zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/>
                      </svg> <label for="name" class="ml-2"> Product Name</label>
                   
                      <input type="text" class="form-control" name="name" value="<%= product.productName %>" readonly >
                    </div>
                    <p class="mt-4"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart3" viewBox="0 0 16 16">
                        <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                      </svg> In-Stock <b><%= product.quantity %></b></p>
                   <div class="mt-4">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                      <path fill-rule="evenodd" d="M8.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H9v1.5a.5.5 0 0 1-1 0V8H6.5a.5.5 0 0 1 0-1H8V5.5a.5.5 0 0 1 .5-.5z"/>
                    </svg> <label for="name" class="ml-2"> New Stock</label>
                 
                    <input type="number" class="form-control " name="quantity" value="0" required>
                   </div>
          
                   <div class="mt-4">
                    <b> &#x20B9;</b> <label for="name" class="ml-2"> Price Per Product</label>
                    
                    <input type="number" class="form-control" name="price" value="<%= product.price %>"  required >
                   </div>
                   <div class="mt-4">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-card-text" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M14.5 3h-13a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"/>
                      <path fill-rule="evenodd" d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>
                    </svg> <label for="name" class="ml-2"> Description </label>
          
                    <textarea  id="" rows="5" class="form-control " formControlName="description" name="productDiscription" required minlength="3" maxlength="500"><%= product.productDiscription %></textarea>
                   </div>
          
                        <button class="btn btn-success btn-block mt-3" >Save Changes</button>
          
                  </form>
                </div>
            </div>
            <div class="col-lg-4"></div>
            <div class="col-lg-4">
               <form  method="POST" action="/admin/<%= product._id%>/delete?_method=DELETE">
                <button class="btn btn-danger btn-block">Delete Product</button>
               </form>
            </div>
        </div>
  </div>

  <script>
    var addtocart = document.querySelector('#addtocart');
var quantity = document.querySelector('select');
var qnt = 1;

var count = document.querySelector('#count')

function addToCart(prod) {


    qnt = parseInt(quantity.value);

    cartNumber(prod);
}

function onLoad() {
    let cartno = localStorage.getItem('cartNumber');
    if (cartno) {
        count.textContent = cartno;
    }
}

function cartNumber(prod) {
    let cartno = localStorage.getItem('cartNumber');
    let cartItem = localStorage.getItem('cartItem')
    cartno = parseInt(cartno)
    if (cartno) {
        localStorage.setItem('cartNumber', cartno + qnt);
        count.textContent = cartno + qnt;
    }
    else {
        localStorage.setItem('cartNumber', qnt)
        count.textContent = qnt;
    }
    setItem(prod, qnt)

}
function setItem(prod, qnt) {
    let cartItems = localStorage.getItem('cartItem');
    cartItems = JSON.parse(cartItems);
    prod = JSON.parse(prod);

    if (cartItems != null) {
        if (cartItems[prod._id] == undefined) {
            prod.incart = qnt;
            cartItems = {
                ...cartItems,
                [prod._id]: prod
            }

        }
        else {
            cartItems[prod._id].incart += qnt;
        }
    }
    else {
        prod.incart = qnt;
        cartItems = {
            [prod._id]: prod
        }
    }

    localStorage.setItem('cartItem', JSON.stringify(cartItems))
    totalCost(prod, qnt);
}

function totalCost(prod, qnt) {

    let total = localStorage.getItem('totalCost');
    if (total != null) {
        total = parseInt(total);
        localStorage.setItem('totalCost', total + (parseInt(prod.price) * qnt))
    }
    else {
        localStorage.setItem('totalCost', prod.price * qnt);
    }
}

onLoad();
  </script>


<script>
  
    $("#zoom").elevateZoom(
        {zoomWindowPosition: 1, zoomWindowOffetx: 10 , borderSize: 0, scrollZoom : true}
    )
</script>
<script>
  $(document).ready(function(){
   

        $(".fixed-top").css("background-color", "#28A745"); 
  });
</script>

<%- include("partials/footer") %>
