<%- include("partials/header") %>
<nav class="navbar navbar-expand-lg navbar-light bg-success">
    <a class="navbar-brand ml-4 text-light" href="#"> Plant Arena</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link ml-4 text-light" href="#">Contact <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link ml-4 text-light" href="#">About us</a>
        </li>
    
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle ml-4 text-light" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Category
          </a>
          <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="#">Action</a>
            <a class="dropdown-item" href="#">Another action</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Something else here</a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link ml-4 text-light" href="/cart"><ion-icon name="cart-outline"></ion-icon> (<span id="count">0</span>)</a>
        </li>
      </ul>
      <form class="form-inline my-2 my-lg-0">
        <!-- <input class="form-control mr-sm-2 searchInputStyle" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button> -->
        <input class="form-control mr-sm-2 searchInputStyle" type="search" placeholder="Search" aria-label="Search">

        <a  data-toggle="collapse" data-target=".navbar-collapse.show"  class=" my-2 my-sm-0 text-white" type="submit"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-search" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"/>
          <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
        </svg></a>
      </form>
 
      <!-- <ul class="navbar-nav">
  
        <li class="nav-item">
          <a class="nav-link ml-4 text-light" href="/Login">Login</a>
        </li>
        <li class="nav-item">
          <a class="nav-link ml-4 text-light" href="/Signup">Sign up</a>
        </li>
    </ul> -->
    <% if(typeof user=='undefined' || !user){ %>
      <a class="nav-item nav-link active text-light" href="/login">login</a>
      <a class="nav-item nav-link active text-light" href="/signup">Sign up</a>
   <% }
   else{ %>
    <div class="dropdown">
      
      <a class="dropdown-toggle mr-5 ml-4 text-light" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <img src="<%= user.avatar %>" alt="" class="userImg"> <%= user.name %>
      </a>
      
      
      <div class="dropdown-menu " aria-labelledby="navbarDropdown">
        <a class="dropdown-item" href="/user/logout" style="text-decoration: none;"><svg class="bi bi-box-arrow-in-left mr-2" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M7.854 11.354a.5.5 0 0 0 0-.708L5.207 8l2.647-2.646a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708 0z"/>
          <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0 0 1h9A.5.5 0 0 0 15 8z"/>
          <path fill-rule="evenodd" d="M2.5 14.5A1.5 1.5 0 0 1 1 13V3a1.5 1.5 0 0 1 1.5-1.5h8A1.5 1.5 0 0 1 12 3v1.5a.5.5 0 0 1-1 0V3a.5.5 0 0 0-.5-.5h-8A.5.5 0 0 0 2 3v10a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-1.5a.5.5 0 0 1 1 0V13a1.5 1.5 0 0 1-1.5 1.5h-8z"/>
        </svg> Logout</a>
      </div>
    </div>
  <%  } %>



    </div>
  </nav>
<div class="container">
    <div class="row mt-5">
        <div class="col-lg-5">
            <div class="card">
                <img src="<%= product.productImage %>" data-zoom-image="<%= product.productImage %>" id="zoom" class="card-img-top" alt="...">
              </div>
        </div>
        <div class="col-lg-1"></div>
        <div class="col-lg-6 mt-5 d-flex justify-content-end">
            <div class="container mt-5">
                
                <h4 class="text-center text-success"><%= product.productName %></h4>
                <h3 class="text-success">&#x20B9; <%= product.price %></h3>
                <h6 class="text-muted">(MRP Inclusive of all taxes)</h6>
                <ul>
                    <li>Shipping Rs 79 for entire order.</li>
                    <li>Cash on delivery</li>
                    <li>Dispatch in 5-8 Days</li>
                </ul>
                      <div style="width: 30%;">
                        <h6 class="text-muted">Quantity</h6>
                          <div >
                            <form>
                              <select class="custom-select">
                                <option selected>1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                               
                              </select>   
                              
                            </form>                    
                      </div>
                        </div>
                            <a class="btn btn-outline-success btn-block mt-4" id="addtocart" onclick="addToCart('<%=JSON.stringify(product) %>')"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart-plus mr-2 align-items-center" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                                <path fill-rule="evenodd" d="M8.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H9v1.5a.5.5 0 0 1-1 0V8H6.5a.5.5 0 0 1 0-1H8V5.5a.5.5 0 0 1 .5-.5z"/>
                              </svg> Add to cart</a>
                    
                        <a class="btn btn-success btn-block" href="/cart"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart-check mr-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                            <path fill-rule="evenodd" d="M11.354 5.646a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L8 8.293l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                          </svg> Buy Now</a>
                     
                </div>
          
            </div>
        </div>

    <div class="mt-3">
        <h5 class="text-success">Description</h5>
    <p><%= product.productDiscription %></p>
    </div>

    <div class="mt-5">
        <h5 class="text-success">Maintains Tip</h5>
        <ul>
            <li> Lorem ipsum dolor sit amet consectetur adipisicing elit.</li>
            <li>Quaerat possimus nisi ullam culpa officia fuga molestiae quisquam ad numquam amet quod</li>
            <li> ut aspernatur voluptates reprehenderit architecto a repellendus corrupti. Ut.</li>
        </ul>
 
    </div>

    <div class="mt-5">
        <h5 class="text-success">Customer Review</h5>
       
 
    </div>
    <div class="mt-5">
        <h5 class="text-success">Related Products</h5>
        <div class="conatiner">
          <div class="row mt-5">
            <% var count=0 %>
          <% data.forEach((ele)=>{ %>
            
            <% if(ele.category == product.category && ele._id != product._id && count < 3){ %>
             <% count++ %>
              <div class="col-lg-4">
                <a href="/detail/<%= ele._id %>">
                 <div class="card" style="width: 18rem;">
                  
                  <span class="text-light rate" >	 <small><b>&#8377; <%= ele.price %>/-</b></small> </span>
                  <img src="<%= ele.productImage %>" class="card-img-top" alt="...">
                  <img class="priceTag" src="https://static.vecteezy.com/system/resources/thumbnails/001/197/142/small/ribbon.png" alt="">
                   <h6 class="text-center mt-2 subText"><%=ele.productName%></h6>
                   <p></p>
                 </div></a>
     
               </div>
           <%  } %>
           <% }) %>
          </div>
        </div>
 
    </div>

  </div>

  <script>
    var addtocart = document.querySelector('#addtocart');
var quantity = document.querySelector('select');
var qnt = 1;

var count = document.querySelector('#count')

function addToCart(prod) {


    qnt = parseInt(quantity.value);

    cartNumber(prod);
}

function onLoad() {
    let cartno = localStorage.getItem('cartNumber');
    if (cartno) {
        count.textContent = cartno;
    }
}

function cartNumber(prod) {
    let cartno = localStorage.getItem('cartNumber');
    let cartItem = localStorage.getItem('cartItem')
    cartno = parseInt(cartno)
    if (cartno) {
        localStorage.setItem('cartNumber', cartno + qnt);
        count.textContent = cartno + qnt;
    }
    else {
        localStorage.setItem('cartNumber', qnt)
        count.textContent = qnt;
    }
    setItem(prod, qnt)

}
function setItem(prod, qnt) {
    let cartItems = localStorage.getItem('cartItem');
    cartItems = JSON.parse(cartItems);
    prod = JSON.parse(prod);

    if (cartItems != null) {
        if (cartItems[prod._id] == undefined) {
            prod.incart = qnt;
            cartItems = {
                ...cartItems,
                [prod._id]: prod
            }

        }
        else {
            cartItems[prod._id].incart += qnt;
        }
    }
    else {
        prod.incart = qnt;
        cartItems = {
            [prod._id]: prod
        }
    }

    localStorage.setItem('cartItem', JSON.stringify(cartItems))
    totalCost(prod, qnt);
}

function totalCost(prod, qnt) {

    let total = localStorage.getItem('totalCost');
    if (total != null) {
        total = parseInt(total);
        localStorage.setItem('totalCost', total + (parseInt(prod.price) * qnt))
    }
    else {
        localStorage.setItem('totalCost', prod.price * qnt);
    }
}

onLoad();
  </script>


<script>
  
    $("#zoom").elevateZoom(
        {zoomWindowPosition: 1, zoomWindowOffetx: 10 , borderSize: 0, scrollZoom : true}
    )
</script>

<%- include("partials/footer") %>
